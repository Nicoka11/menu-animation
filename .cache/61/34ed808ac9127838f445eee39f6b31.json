{"id":"node_modules/utils.js/index.js","dependencies":[{"name":"G:\\Z - Web Training\\menu-animation\\package.json","includedInParent":true,"mtime":1619633306767},{"name":"G:\\Z - Web Training\\menu-animation\\node_modules\\utils.js\\package.json","includedInParent":true,"mtime":1619633306731},{"name":"url","loc":{"line":24,"column":24},"parent":"G:\\Z - Web Training\\menu-animation\\node_modules\\utils.js\\index.js","resolved":"C:\\Users\\nicok\\AppData\\Roaming\\npm\\node_modules\\parcel-bundler\\node_modules\\url\\url.js"},{"name":"http","loc":{"line":25,"column":19},"parent":"G:\\Z - Web Training\\menu-animation\\node_modules\\utils.js\\index.js","resolved":"C:\\Users\\nicok\\AppData\\Roaming\\npm\\node_modules\\parcel-bundler\\node_modules\\stream-http\\index.js"},{"name":"https","loc":{"line":26,"column":20},"parent":"G:\\Z - Web Training\\menu-animation\\node_modules\\utils.js\\index.js","resolved":"C:\\Users\\nicok\\AppData\\Roaming\\npm\\node_modules\\parcel-bundler\\node_modules\\https-browserify\\index.js"},{"name":"util","loc":{"line":27,"column":19},"parent":"G:\\Z - Web Training\\menu-animation\\node_modules\\utils.js\\index.js","resolved":"C:\\Users\\nicok\\AppData\\Roaming\\npm\\node_modules\\parcel-bundler\\node_modules\\util\\util.js"},{"name":"path","loc":{"line":28,"column":19},"parent":"G:\\Z - Web Training\\menu-animation\\node_modules\\utils.js\\index.js","resolved":"C:\\Users\\nicok\\AppData\\Roaming\\npm\\node_modules\\parcel-bundler\\node_modules\\path-browserify\\index.js"},{"name":"fs","loc":{"line":29,"column":17},"parent":"G:\\Z - Web Training\\menu-animation\\node_modules\\utils.js\\index.js","resolved":"C:\\Users\\nicok\\AppData\\Roaming\\npm\\node_modules\\parcel-bundler\\src\\builtins\\_empty.js"},{"name":"events","loc":{"line":30,"column":21},"parent":"G:\\Z - Web Training\\menu-animation\\node_modules\\utils.js\\index.js","resolved":"C:\\Users\\nicok\\AppData\\Roaming\\npm\\node_modules\\parcel-bundler\\node_modules\\events\\events.js"},{"name":"crypto","loc":{"line":31,"column":21},"parent":"G:\\Z - Web Training\\menu-animation\\node_modules\\utils.js\\index.js","resolved":"C:\\Users\\nicok\\AppData\\Roaming\\npm\\node_modules\\parcel-bundler\\node_modules\\crypto-browserify\\index.js"},{"name":"process","parent":"G:\\Z - Web Training\\menu-animation\\node_modules\\utils.js\\index.js","resolved":"C:\\Users\\nicok\\AppData\\Roaming\\npm\\node_modules\\parcel-bundler\\node_modules\\process\\browser.js"},{"name":"buffer","parent":"G:\\Z - Web Training\\menu-animation\\node_modules\\utils.js\\index.js","resolved":"C:\\Users\\nicok\\AppData\\Roaming\\npm\\node_modules\\parcel-bundler\\node_modules\\buffer\\index.js"}],"generated":{"js":"var global = arguments[3];\nvar process = require(\"process\");\nvar Buffer = require(\"buffer\").Buffer;\n// Copyright Peter Širka, Web Site Design s.r.o. (www.petersirka.sk)\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar urlParser = require('url');\nvar http = require('http');\nvar https = require('https');\nvar util = require('util');\nvar path = require('path');\nvar fs = require('fs');\nvar events = require('events');\nvar crypto = require('crypto');\nvar regexpMail = new RegExp('^[a-zA-Z0-9-_.]+@[a-zA-Z0-9.-]+\\\\.[a-zA-Z]{2,4}$');\nvar regexpUrl = new RegExp('^(http[s]?:\\\\/\\\\/(www\\\\.)?|ftp:\\\\/\\\\/(www\\\\.)?|www\\\\.){1}([0-9A-Za-z-\\\\.@:%_\\+~#=]+)+((\\\\.[a-zA-Z]{2,3})+)(/(.)*)?(\\\\?(.)*)?');\nvar expressionCache = {};\n\nvar LINK_1 = /(\\b(https?|ftp|file):\\/\\/[-A-Z0-9+&@#\\/%?=~_|!:,.;]*[-A-Z0-9+&@#\\/%=~_|])/ig;\nvar LINK_2 = /(^|[^\\/])(www\\.[\\S]+(\\b|$))/gim;\nvar EMAIL = new RegExp('[a-zA-Z0-9-_.]+@[a-zA-Z0-9.-]+\\\\.[a-zA-Z]{2,4}');\n\nvar VERSION = '1.0.1';\nvar ENCODING = 'utf8';\nvar UNDEFINED = 'undefined';\nvar STRING = 'string';\nvar FUNCTION = 'function';\nvar NUMBER = 'number';\nvar OBJECT = 'object';\nvar BOOLEAN = 'boolean';\nvar NEWLINE = '\\r\\n';\n\nif (typeof(setImmediate) === UNDEFINED) {\n\tglobal.setImmediate = function(cb) {\n\t\tprocess.nextTick(cb);\n\t};\n}\n\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\n\n/*\n\tExpression declaration\n\t@query {String}\n\t@params {String Array}\n\t@values {Object Array}\n\treturn {Function}\n*/\nfunction expression(query, params) {\n\n\tvar name = params.join(',');\n\tvar fn = expressionCache[query + '-' + name];\n\n\tif (!fn) {\n\t\tfn = eval('(function(' + name +'){' + (query.indexOf('return') === -1 ? 'return ' : '') + query + '})');\n\t\texpressionCache[query + name] = fn;\n\t}\n\n\tvar values = [];\n\n\tfor (var i = 2; i < arguments.length; i++)\n\t\tvalues.push(arguments[i]);\n\n\treturn (function() {\n\t\tvar arr = [];\n\n\t\tfor (var i = 0; i < arguments.length; i++)\n\t\t\tarr.push(arguments[i]);\n\n\t\tfor (var i = 0; i < values.length; i++)\n\t\t\tarr.push(values[i]);\n\n\t\treturn fn.apply(this, arr);\n\t});\n}\n\n/*\n\t@obj {Object}\n*/\nexports.isEmpty = function(obj) {\n\n\tif (obj === null)\n\t\treturn true;\n\n\tif (obj.length && obj.length > 0)\n\t\treturn false;\n\n\tif (obj.length === 0)\n\t\treturn true;\n\n\tfor (var key in obj) {\n\t\tif (hasOwnProperty.call(obj, key))\n\t\treturn false;\n\t}\n\treturn true;\n};\n\n/*\n\tSend request to URL\n\t@url {String}\n\t@method {String}\n    @data {String}\n    @callback {Function} :: function(error, data, statusCode, headers)\n    @headers {Object} :: optional, default {}\n    @encoding {String} :: optional, default utf8\n    @timeout {Number} :: optional, default 10000\n*/\nexports.request = function(url, method, data, callback, headers, encoding, timeout) {\n\n\tvar uri = urlParser.parse(url);\n\tvar h = {};\n\tvar isJSON = typeof(data) === OBJECT;\n\n\tencoding = encoding || ENCODING;\n\tmethod = (method || '').toString().toUpperCase();\n\n\tif (method !== 'GET')\n\t\th['Content-Type'] = 'application/x-www-form-urlencoded';\n\n\tif (isJSON)\n\t\th['Content-Type'] = 'application/json';\n\n\tutil._extend(h, headers);\n\n\th['X-Powered-By'] = 'utils.js v' + VERSION;\n\tvar options = { protocol: uri.protocol, auth: uri.auth, method: method, hostname: uri.hostname, port: uri.port, path: uri.path, agent: false, headers: h };\n\n\tvar response = function(res) {\n\n\t\tif (!callback) {\n\t\t\tres.resume();\n\t\t\treturn;\n\t\t}\n\n\t\tres._buffer = '';\n\n\t\tres.on('data', function(chunk) {\n\t\t\tthis._buffer += chunk.toString(encoding);\n\t\t});\n\n\t\tres.on('end', function() {\n\t\t\tcallback(null, this._buffer, res.statusCode, res.headers);\n\t\t});\n\n\t\tres.resume();\n\t};\n\n\tvar con = options.protocol === 'https:' ? https : http;\n\n\ttry\n\t{\n\n\t\tvar isPOST = method === 'POST' || method === 'PUT';\n\t\tvar req = isPOST ? callback ? con.request(options, response) : con.request(options) : callback ? con.get(options, response) : con.get(options);\n\n\t\tif (callback) {\n\t\t\treq.on('error', function(error) {\n\t\t\t\tcallback(error, null, 0, {});\n\t\t\t});\n\n\t\t\treq.setTimeout(timeout || 10000, function() {\n\t\t\t\tcallback(new Error(exports.httpStatus(408)), null, 0, {});\n\t\t\t});\n\t\t}\n\n\t\tif (isPOST)\n\t\t\treq.end(isJSON ? JSON.stringify(data) : (data || '').toString(), encoding);\n\n\t} catch (ex) {\n\t\tif (callback)\n\t\t\tcallback(ex, null, 0, {});\n\t\treturn false;\n\t}\n\n\treturn true;\n};\n\n/*\n\tDownload content from URL\n\t@url {String}\n\t@callback {Function} :: optional, params: @err {Error}, @response {Response}\n\t@headers {Object} :: optional, additional headers\n\t@method {String} :: optional, default POST,\n\t@params {String} :: optional custom params (for POST or PUT method)\n\t@encoding {String} :: optional, default utf8\n*/\nexports.download = function(url, callback, headers, method, params, encoding) {\n\n\tvar uri = urlParser.parse(url);\n\tvar h = {};\n\n\tmethod = (method || '').toString().toUpperCase();\n\tencoding = encoding || ENCODING;\n\n\tutil._extend(h, headers);\n\th['X-Powered-By'] = 'utils.js v' + VERSION;\n\tvar options = { protocol: uri.protocol, auth: uri.auth, method: method, hostname: uri.hostname, port: uri.port, path: uri.path, agent: false, headers: h };\n\n\tvar response = function(res) {\n\t\tcallback(null, res);\n\t};\n\n\tvar con = options.protocol === 'https:' ? https : http;\n\n\ttry\n\t{\n\n\t\tvar isPOST = method === 'POST' || method === 'PUT';\n\t\tvar req = isPOST ? callback ? con.request(options, response) : con.request(options) : callback ? con.get(options, response) : con.get(options);\n\n\t\tif (callback) {\n\t\t\treq.on('error', function(error) {\n\t\t\t\tcallback(error, null);\n\t\t\t});\n\t\t}\n\n\t\tif (isPOST)\n\t\t\treq.end((params || '').toString(), ENCODING);\n\n\t} catch (ex) {\n\t\tif (callback)\n\t\t\tcallback(ex, null);\n\t\treturn false;\n\t}\n\n\treturn true;\n};\n\n/*\n\tSend a stream through HTTP\n\t@name {String} :: filename with extension\n\t@stream {ReadableStream or String (filename)}\n\t@url {String}\n\t@callback {Function} :: optional, params: @err {Error}, @response {String}\n\t@headers {Object} :: optional, additional headers\n\t@method {String} :: optional, default POST\n*/\nexports.send = function(name, stream, url, callback, headers, method) {\n\n\tvar self = this;\n\n\tif (typeof(callback) === 'object') {\n\t\tvar tmp = headers;\n\t\tcallback = headers;\n\t\theaders = tmp;\n\t}\n\n\tif (typeof(stream) === STRING)\n\t\tstream = fs.createReadStream(stream, { flags: 'r' });\n\n\tvar BOUNDARY = '----' + Math.random().toString(16).substring(2);\n\tvar h = {};\n\n\tif (headers)\n\t\tutil._extend(h, headers);\n\n\tname = path.basename(name);\n\n\th['Cache-Control'] = 'max-age=0';\n\th['Content-Type'] = 'multipart/form-data; boundary=' + BOUNDARY;\n\th['X-Powered-By'] = 'utils.js v' + VERSION;\n\n\tvar uri = urlParser.parse(url);\n\tvar options = { protocol: uri.protocol, auth: uri.auth, method: method || 'POST', hostname: uri.hostname, port: uri.port, path: uri.path, agent: false, headers: h };\n\n\tvar response = function(res) {\n\n\t\tif (!callback)\n\t\t\treturn;\n\n\t\tres.body = '';\n\t\tres.on('data', function(chunk) {\n\t\t\tthis.body += chunk.toString(ENCODING);\n\t\t});\n\n\t\tres.on('end', function() {\n\t\t\tcallback(null, res.body);\n\t\t});\n\n\t};\n\n\tvar connection = options.protocol === 'https:' ? https : http;\n\tvar req = connection.request(options, response);\n\n\tif (callback) {\n\t\treq.on('error', function(err) {\n\t\t\tcallback(err, null);\n\t\t});\n\t}\n\n\tvar header = NEWLINE + NEWLINE + '--' + BOUNDARY + NEWLINE + 'Content-Disposition: form-data; name=\"File\"; filename=\"' + name + '\"' + NEWLINE + 'Content-Type: ' + utils.getContentType(path.extname(name)) + NEWLINE + NEWLINE;\n\treq.write(header);\n\n\tstream.on('end', function() {\n\t\treq.end(NEWLINE + NEWLINE + '--' + BOUNDARY + '--');\n\t});\n\n\tstream.pipe(req, { end: false });\n\n\treturn self;\n};\n\n/*\n\tTRIM string properties\n\t@obj {Object}\n\treturn {Object}\n*/\nexports.trim = function(obj) {\n\n\tvar type = typeof(obj);\n\n\tif (type === STRING)\n\t\treturn obj.trim();\n\n\tif (type !== OBJECT)\n\t\treturn obj;\n\n\tObject.keys(obj).forEach(function(name) {\n\t\tvar val = obj[name];\n\n\t\tif (typeof(val) === OBJECT) {\n\t\t\texports.trim(val);\n\t\t\treturn;\n\t\t}\n\n\t\tif (typeof(val) !== STRING)\n\t\t\treturn;\n\n\t\tobj[name] = val.trim();\n\t});\n\n\treturn obj;\n};\n\n/*\n\tEmpty function\n*/\nexports.noop = function() {};\n\n/*\n\tGet HTTP Status description\n\t@code {Number}\n\t@addCode {Boolean} :: optional, default true\n\treturn {String}\n*/\nexports.httpStatus = function(code, addCode) {\n\n\tvar plus = addCode || true ? code + ': ' : '';\n\tswitch(code) {\n\t\tcase 200: return plus + 'OK';\n\t\tcase 201: return plus + 'Created';\n\t\tcase 202: return plus + 'Accepted';\n\t\tcase 203: return plus + 'Non-Authoritative Information';\n\t\tcase 204: return plus + 'No Content';\n\t\tcase 205: return plus + 'Reset Content';\n\t\tcase 206: return plus + 'Partial Content';\n\t\tcase 300: return plus + 'Multiple Choices';\n\t\tcase 301: return plus + 'Moved Permanently';\n\t\tcase 302: return plus + 'Found';\n\t\tcase 303: return plus + 'See Other';\n\t\tcase 304: return plus + 'Not Modified';\n\t\tcase 306: return plus + 'Switch Proxy';\n\t\tcase 307: return plus + 'Temporary Redirect';\n\t\tcase 308: return plus + 'Resume Incomplete';\n\t\tcase 400: return plus + 'Bad Request';\n\t\tcase 401: return plus + 'Unauthorized';\n\t\tcase 402: return plus + 'Payment Required';\n\t\tcase 403: return plus + 'Forbidden';\n\t\tcase 404: return plus + 'Not Found';\n\t\tcase 405: return plus + 'Method Not Allowed';\n\t\tcase 406: return plus + 'Not Acceptable';\n\t\tcase 407: return plus + 'Proxy Authentication Required';\n\t\tcase 408: return plus + 'Request Timeout';\n\t\tcase 409: return plus + 'Conflict';\n\t\tcase 410: return plus + 'Gone';\n\t\tcase 411: return plus + 'Length Required';\n\t\tcase 412: return plus + 'Precondition Failed';\n\t\tcase 413: return plus + 'Request Entity Too Large';\n\t\tcase 414: return plus + 'Request-URI Too Long';\n\t\tcase 415: return plus + 'Unsupported Media Type';\n\t\tcase 416: return plus + 'Requested Range Not Satisfiable';\n\t\tcase 417: return plus + 'Expectation Failed';\n\t\tcase 431: return plus + 'Request Header Fields Too Large';\n\t\tcase 500: return plus + 'Internal Server Error';\n\t\tcase 501: return plus + 'Not Implemented';\n\t\tcase 502: return plus + 'Bad Gateway';\n\t\tcase 503: return plus + 'Service Unavailable';\n\t\tcase 504: return plus + 'Gateway Timeout';\n\t\tcase 505: return plus + 'HTTP Version Not Supported';\n\t\tcase 511: return plus + 'Network Authentication Required';\n\t}\n\treturn null;\n};\n\n/*\n\tExtend object\n\t@target {Object}\n\t@source {Object}\n\t@rewrite {Boolean} :: option, default false\n\treturn {Object}\n*/\nexports.extend = function(target, source, rewrite) {\n\n\tif (target === null || source === null)\n\t\treturn target;\n\n\tif (typeof(target) !== OBJECT || typeof(source) !== OBJECT)\n\t\treturn target;\n\n\tvar keys = Object.keys(source);\n\tvar i = keys.length;\n\n\twhile (i--) {\n\n\t\tvar key = keys[i];\n\n\t\tif (rewrite || typeof(target[key]) === UNDEFINED)\n\t\t\ttarget[key] = source[key];\n\t}\n\n\treturn target;\n};\n\n/*\n\tCopy values\n\t@target {Object}\n\t@source {Object}\n\t@rewrite {Boolean} :: option, default true\n\treturn {Object}\n*/\nexports.copy = function(target, source, rewrite) {\n\n\tif (target === null || source === null)\n\t\treturn target;\n\n\tif (typeof(target) !== OBJECT || typeof(source) !== OBJECT)\n\t\treturn target;\n\n\tif (typeof(rewrite) === UNDEFINED)\n\t\trewrite = true;\n\n\tvar keys = Object.keys(source);\n\tvar i = keys.length;\n\n\twhile (i--) {\n\n\t\tvar key = keys[i];\n\n\t\tif (typeof(target[key]) === UNDEFINED)\n\t\t\tcontinue;\n\n\t\tif (rewrite) {\n\t\t\ttarget[key] = source[key];\n\t\t\tcontinue;\n\t\t}\n\n\t\ttarget[key] = source[key];\n\t}\n\n\treturn target;\n};\n\n/*\n\tReduce object properties\n\t@source {Object}\n\t@prop {String array or Object} :: property name\n\treturn @source\n*/\nexports.reduce = function(source, prop) {\n\n\tif (source === null || prop === null)\n\t\treturn source;\n\n\tvar type = typeof(prop);\n\n\tif (prop instanceof Array) {\n\t\tObject.keys(source).forEach(function(o) {\n\t\t\tif (prop.indexOf(o) === -1)\n\t\t\t\tdelete source[o];\n\t\t});\n\t}\n\n\tif (type === OBJECT) {\n\t\tvar obj = Object.keys(prop);\n\t\tObject.keys(source).forEach(function(o) {\n\t\t\tif (obj.indexOf(o) === -1)\n\t\t\t\tdelete source[o];\n\t\t});\n\t}\n\n\treturn source;\n};\n\n/*\n\tIs relative URL?\n\t@url {String}\n\treturn {Boolean}\n*/\nexports.isRelative = function(url) {\n\treturn !(url.substring(0, 2) === '//' || url.indexOf('http://') !== -1 || url.indexOf('https://') !== -1);\n};\n\n/*\n\tEncode HTML\n\t@str {String}\n\treturn {String}\n*/\nexports.htmlEncode = function(str) {\n\n\tvar type = typeof(str);\n\n\tif (type === UNDEFINED)\n\t\treturn '';\n\n\tif (type !== STRING)\n\t\tstr = str.toString();\n\n\treturn str.htmlEncode();\n};\n\n/*\n\tDecode HTML\n\t@str {String}\n\treturn {String}\n*/\nexports.htmlDecode = function(str) {\n\n\tvar type = typeof(str);\n\n\tif (type === UNDEFINED)\n\t\treturn '';\n\n\tif (type !== STRING)\n\t\tstr = str.toString();\n\n\treturn str.htmlDecode();\n};\n\n/*\n\tIs static file?\n\t@url {String}\n\treturn {Boolean}\n*/\nexports.isStaticFile = function(url) {\n\tvar pattern = /\\.\\w{2,8}($|\\?)+/g;\n\treturn pattern.test(url);\n};\n\n/*\n\t@str {String}\n\treturn {Boolean}\n*/\nexports.isNullOrEmpty = function(str) {\n\n\tif (typeof(str) !== STRING)\n\t\treturn true;\n\n\treturn str.length === 0;\n};\n\n/*\n\tparseInt\n\t@obj {Object}\n\t@def {Number}\n\treturn {Number}\n*/\nexports.parseInt = function(obj, def) {\n\tvar type = typeof(obj);\n\n\tif (type === UNDEFINED)\n\t\treturn def || 0;\n\n\tvar str = type !== STRING ? obj.toString() : obj;\n    return str.parseInt(def, 10);\n};\n\n/*\n\tparseFloat\n\t@obj {Object}\n\t@def {Number}\n\treturn {Number}\n*/\nexports.parseFloat = function(obj, def) {\n\tvar type = typeof(obj);\n\n\tif (type === UNDEFINED)\n\t\treturn def || 0;\n\n\tvar str = type !== STRING ? obj.toString() : obj;\n    return str.parseFloat(def);\n};\n\n/*\n\tIs array?\n\t@obj {Object}\n\treturn {Boolean}\n*/\nexports.isArray = function(obj) {\n\treturn util.isArray(obj);\n};\n\n/*\n\tIs date?\n\t@obj {Object}\n\treturn {Boolean}\n*/\nexports.isDate = function(obj) {\n\treturn util.isDate(obj);\n};\n\n/*\n\tGet Content Type from extension\n\t@ext {String}\n\treturn {String}\n*/\nexports.getContentType = function(ext) {\n\n\tif (ext[0] === '.')\n\t\text = ext.substring(1);\n\n\tvar extension = {\n\t\t'ai': 'application/postscript',\n\t\t'appcache': 'text/cache-manifest',\n\t\t'avi': 'video/avi',\n\t\t'bin': 'application/octet-stream',\n\t\t'bmp': 'image/bmp',\n\t\t'css': 'text/css',\n\t\t'less': 'text/css',\n\t\t'sass': 'text/css',\n\t\t'csv': 'text/csv',\n\t\t'doc': 'application/msword',\n\t\t'docx': 'application/msword',\n\t\t'dtd': 'application/xml-dtd',\n\t\t'eps': 'application/postscript',\n\t\t'exe': 'application/octet-stream',\n\t\t'gif': 'image/gif',\n\t\t'gzip': 'application/x-gzip',\n\t\t'htm': 'text/html',\n\t\t'html': 'text/html',\n\t\t'ico': 'image/x-icon',\n\t\t'ics': 'text/calendar',\n\t\t'ifb': 'text/calendar',\n\t\t'jpe': 'image/jpeg',\n\t\t'jpeg': 'image/jpeg',\n\t\t'jpg': 'image/jpeg',\n\t\t'js': 'text/javascript',\n\t\t'm4a': 'audio/mp4a-latm',\n\t\t'm4v': 'video/x-m4v',\n\t\t'md': 'text/markdown',\n\t\t'mid': 'audio/midi',\n\t\t'midi': 'audio/midi',\n\t\t'mov': 'video/quicktime',\n\t\t'mp3': 'audio/mpeg',\n\t\t'mp4': 'video/mp4',\n\t\t'mpe': 'video/mpeg',\n\t\t'mpeg': 'video/mpeg',\n\t\t'mpg': 'video/mpeg',\n\t\t'mpga': 'audio/mpeg',\n\t\t'mv4': 'video/mv4',\n\t\t'ogg': 'application/ogg',\n\t\t'pdf': 'application/pdf',\n\t\t'png': 'image/png',\n\t\t'ppt': 'application/vnd.ms-powerpoint',\n\t\t'pptx': 'application/vnd.ms-powerpoint',\n\t\t'ps': 'application/postscript',\n\t\t'rar': 'application/x-rar-compressed',\n\t\t'rtf': 'text/rtf',\n\t\t'sh': 'application/x-sh',\n\t\t'svg': 'image/svg+xml',\n\t\t'swf': 'application/x-shockwave-flash',\n\t\t'tar': 'application/x-tar',\n\t\t'tif': 'image/tiff',\n\t\t'tiff': 'image/tiff',\n\t\t'txt': 'text/plain',\n\t\t'wav': 'audio/x-wav',\n\t\t'webp': 'image/webp',\n\t\t'woff': 'font/woff',\n\t\t'xht': 'application/xhtml+xml',\n\t\t'xhtml': 'application/xhtml+xml',\n\t\t'xls': 'application/vnd.ms-excel',\n\t\t'xlsx': 'application/vnd.ms-excel',\n\t\t'xml': 'application/xml',\n\t\t'xpm': 'image/x-xpixmap',\n\t\t'xsl': 'application/xml',\n\t\t'xslt': 'application/xslt+xml',\n\t\t'zip': 'application/zip'\n\t};\n\n\treturn extension[ext.toLowerCase()] || 'application/octet-stream';\n};\n\n/*\n\tCreate ETag from string\n\t@text {String} :: filename\n\t@version {String} :: optional\n\treturn {String}\n*/\nexports.etag = function(text, version) {\n\tvar sum = 0;\n\tfor (var i = 0; i < text.length; i++)\n\t\tsum += text.charCodeAt(i);\n\treturn sum.toString() + (version ? ':' + version : '');\n};\n\n/*\n\tAdd @delimiter to end of @path\n\t@path {String} :: filename\n\t@delimiter {String} :: optional, default /\n\treturn {String}\n*/\nexports.path = function(path, delimiter) {\n\tdelimiter = delimiter || '/';\n\tif (path[path.length - 1] === delimiter)\n\t\treturn path;\n\treturn path + delimiter;\n};\n\n/*\n\tGet random number\n\t@max {Number}\n\t@min {Number}\n\treturn {Number}\n*/\nexports.random = function(max, min) {\n\tmax = (max || 100000);\n\tmin = (min || 0);\n\treturn Math.floor(Math.random() * (max - min + 1)) + min;\n};\n\n/*\n\tCreate unique identifier\n\t@max {Number} :: optional, default 40\n\treturn {String}\n*/\nexports.GUID = function(max) {\n\n\tmax = max || 40;\n\n    var rnd = function () {\n        return Math.floor(Math.random() * 65536).toString(16);\n    };\n\n    var str = '';\n    for (var i = 0; i < (max / 4) + 1; i++)\n\t\tstr += rnd();\n\n    return str.substring(0, max);\n};\n\n/*\n\tValidate\n\t@model {Object} :: object to validate\n\t@properties {String array}\n\t@prepare {Function} : return utils.isValid() OR {Boolean} :: true is valid\n\t@builder {ErrorBuilder}\n\t@resource {Function} :: function(key) return {String}\n\treturn {ErrorBuilder}\n*/\nexports.validate = function(model, properties, prepare, builder, resource) {\n\n\tif (typeof(builder) === FUNCTION && typeof(resource) === UNDEFINED) {\n\t\tresource = builder;\n\t\tbuilder = null;\n\t}\n\n\tvar error = builder;\n\n\tif (!(error instanceof builders.ErrorBuilder))\n\t\terror = new builders.ErrorBuilder(resource);\n\n\tif (typeof(properties) === STRING) {\n\t\tvar schema = builders.validation(properties);\n\t\tif (schema.length === 0)\n\t\t\tproperties = properties.replace(/\\s/g, '').split(',');\n\t\telse\n\t\t\tproperties = schema;\n\t}\n\n\tif (typeof(model) === UNDEFINED || model === null)\n\t\tmodel = {};\n\n\tif (typeof(prepare) !== FUNCTION)\n\t\tthrow new Error('Validate hasn\\'t any method to validate properties.');\n\n\tfor (var i = 0; i < properties.length; i++) {\n\n\t\tvar type = typeof(value);\n\t\tvar name = properties[i].toString();\n\t\tvar value = (type === FUNCTION ? model[name]() : model[name]) || '';\n\n\t\tif (type === OBJECT) {\n\t\t\terror.add(exports.validate(value, properties, prepare, error, builder, resource));\n\t\t\tcontinue;\n\t\t}\n\n\t\tvar result = prepare(name, value);\n\n\t\tif (typeof(result) === UNDEFINED)\n\t\t\tcontinue;\n\n\t\ttype = typeof(result);\n\n\t\tif (type === STRING) {\n\t\t\terror.add(name, result);\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (type === BOOLEAN) {\n\t\t\tif (!result)\n\t\t\t\terror.add(name, '@');\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (result.isValid === false)\n\t\t\terror.add(name, result.error);\n\t}\n\n\treturn error;\n};\n\n/*\n\tValidation object\n\t@isValid {Boolean}\n\t@error {String} :: optional, default @\n\treturn {Object}\n*/\nexports.isValid = function(valid, error) {\n\treturn { isValid: valid, error: error || '@' };\n};\n\n/*\n\tEmail address validation\n\t@str {String}\n\treturn {Boolean}\n*/\nexports.isEmail = function(str) {\n\treturn (str || '').toString().isEmail();\n};\n\n/*\n\tURL address validation\n\t@str {String}\n\treturn {Boolean}\n*/\nexports.isURL = function(str) {\n\treturn (str || '').toString().isURL();\n};\n\n/*\n\tCombine path\n\t@arguments {String array}\n\treturn {String}\n*/\nexports.combine = function() {\n\treturn '.' + path.join.apply(this, arguments);\n};\n\n/*\n\t@str {String}\n\treturn {String}\n*/\nexports.removeDiacritics = function(str) {\n    var dictionaryA = ['á', 'ä', 'č', 'ď', 'é', 'ě', 'ť', 'ž', 'ú', 'ů', 'ü', 'í', 'ï', 'ô', 'ó', 'ö', 'š', 'ľ', 'ĺ', 'ý', 'ÿ', 'č', 'ř'];\n    var dictionaryB = ['a', 'a', 'c', 'd', 'e', 'e', 't', 'z', 'u', 'u', 'u', 'i', 'i', 'o', 'o', 'o', 's', 'l', 'l', 'y', 'y', 'c', 'r'];\n    var buf = [];\n    for (var i = 0; i < str.length; i++) {\n        var c = str[i];\n        var isUpper = false;\n\n        var index = dictionaryA.indexOf(c);\n        if (index === -1) {\n            index = dictionaryA.indexOf(c.toLowerCase());\n            isUpper = true;\n        }\n\n        if (index === -1) {\n            buf.push(c);\n            continue;\n        }\n\n        c = dictionaryB[index];\n        if (isUpper)\n            c = c.toUpperCase();\n\n        buf.push(c);\n    }\n    return buf.join('');\n};\n\n/*\n\t@type {String}\n\t@value {Number}\n\treturn {Date}\n*/\nDate.prototype.add = function(type, value) {\n\tvar self = this;\n\tswitch(type) {\n\t\tcase 's':\n\t\tcase 'ss':\n\t\tcase 'second':\n\t\tcase 'seconds':\n\t\t\tself.setSeconds(self.getSeconds() + value);\n\t\t\treturn self;\n\t\tcase 'm':\n\t\tcase 'mm':\n\t\tcase 'minute':\n\t\tcase 'minutes':\n\t\t\tself.setMinutes(self.getMinutes() + value);\n\t\t\treturn self;\n\t\tcase 'h':\n\t\tcase 'hh':\n\t\tcase 'hour':\n\t\tcase 'hours':\n\t\t\tself.setHours(self.getHours() + value);\n\t\t\treturn self;\n\t\tcase 'd':\n\t\tcase 'dd':\n\t\tcase 'day':\n\t\tcase 'days':\n\t\t\tself.setDate(self.getDate() + value);\n\t\t\treturn self;\n\t\tcase 'M':\n\t\tcase 'MM':\n\t\tcase 'month':\n\t\tcase 'months':\n\t\t\tself.setMonth(self.getMonth() + value);\n\t\t\treturn self;\n\t\tcase 'y':\n\t\tcase 'yyyy':\n\t\tcase 'year':\n\t\tcase 'years':\n\t\t\tself.setFullYear(self.getFullYear() + value);\n\t\t\treturn self;\n\t}\n\treturn self;\n};\n\n/*\n\tFormat date to string\n\t@format {String}\n\treturn {String}\n*/\nDate.prototype.format = function(format) {\n\tvar self = this;\n\n\tvar h = self.getHours();\n\tvar m = self.getMinutes().toString();\n\tvar s = self.getSeconds().toString();\n\tvar M = (self.getMonth() + 1).toString();\n\tvar yyyy = self.getFullYear().toString();\n\tvar d = self.getDate().toString();\n\n\tvar a = 'AM';\n\tvar H = h.toString();\n\n\n\tif (h >= 12) {\n\t\th -= 12;\n\t\ta = 'PM';\n\t}\n\n\tif (h === 0)\n\t\th = 12;\n\n\th = h.toString();\n\n\tvar hh = h.padLeft(2, '0');\n\tvar HH = H.padLeft(2, '0');\n\tvar mm = m.padLeft(2, '0');\n\tvar ss = s.padLeft(2, '0');\n\tvar MM = M.padLeft(2, '0');\n\tvar dd = d.padLeft(2, '0');\n\tvar yy = yyyy.substring(2);\n\n\treturn format.replace(/yyyy/g, yyyy).replace(/yy/g, yy).replace(/MM/g, MM).replace(/M/g, M).replace(/dd/g, dd).replace(/d/g, d).replace(/HH/g, HH).replace(/H/g, H).replace(/hh/g, hh).replace(/h/g, h).replace(/mm/g, mm).replace(/m/g, m).replace(/ss/g, ss).replace(/s/g, ss).replace(/a/g, a);\n};\n\nif (!String.prototype.trim) {\n\tString.prototype.trim = function() {\n\t\treturn this.replace(/^[\\s]+|[\\s]+$/g, '');\n\t};\n}\n\n/*\n\tCount text in string\n\t@text {String}\n\treturn {Number}\n*/\nString.prototype.count = function(text) {\n    var index = 0;\n    var count = 0;\n    do {\n\n        index = this.indexOf(text, index + text.length);\n\n        if (index > 0)\n            count++;\n\n    } while (index > 0);\n    return count;\n};\n\nString.prototype.parseDate = function() {\n\treturn new Date(this.toString());\n};\n\n/*\n\tContain string a array values?\n\t@value {String or String Array}\n\t@mustAll {Boolean} :: optional (default false), String must contains all items in String array\n\treturn {Boolean}\n*/\nString.prototype.contains = function(value, mustAll) {\n\n\tvar str = this.toString();\n\n\tif (typeof(value) === STRING)\n\t\treturn str.indexOf(value) !== -1;\n\n\tfor (var i = 0; i < value.length; i++) {\n\t\tvar exists = str.indexOf(value[i]) !== -1;\n\n\t\tif (mustAll) {\n\t\t\tif (!exists)\n\t\t\t\treturn false;\n\t\t} else if (exists)\n\t\t\treturn true;\n\t}\n\n\treturn mustAll ? true : false;\n};\n\n/*\n\tParse configuration from string\n\treturn {Object}\n*/\nString.prototype.configuration = function() {\n\n\tvar arr = this.split('\\n');\n\tvar length = arr.length;\n\tvar obj = {};\n\n\tfor (var i = 0; i < length; i++) {\n\n\t\tvar str = arr[i];\n\n\t\tif (str === '')\n\t\t\tcontinue;\n\n\t\tif (str.substring(0, 2) === '//')\n\t\t\tcontinue;\n\n\t\tvar index = str.indexOf(':');\n\t\tif (index === -1)\n\t\t\tcontinue;\n\n\t\tobj[str.substring(0, index).trim()] = str.substring(index + 1).trim();\n\t}\n\n\treturn obj;\n};\n\n/*\n\t@arguments {Object array}\n\treturn {String}\n*/\nString.prototype.format = function() {\n    var formatted = this;\n    for (var i = 0; i < arguments.length; i++) {\n        var regexp = new RegExp('\\\\{' + i + '\\\\}', 'gi');\n        formatted = formatted.replace(regexp, arguments[i]);\n    }\n    return formatted;\n};\n\nString.prototype.htmlEncode = function() {\n\treturn this.replace(/\\&/g, '&amp;').replace(/\\>/g, '&gt;').replace(/\\</g, '&lt;').replace(/\\\"/g, '&quot;');\n};\n\nString.prototype.htmlDecode = function() {\n\treturn this.replace(/&gt;/g, '>').replace(/\\&lt;/g, '<').replace(/\\&quot;/g, '\"').replace(/&amp;/g, '&');\n};\n\nString.prototype.urlEncode = function() {\n\treturn encodeURIComponent(this);\n};\n\nString.prototype.urlDecode = function() {\n\treturn decodeURIComponent(this);\n};\n\n/*\n\tSimple templating :: Hello {name}, your score: {score}, your price: {price | ### ###.##}, date: {date | dd.MM.yyyy}\n\t@obj {Object}\n\treturn {String}\n*/\nString.prototype.params = function(obj) {\n    var formatted = this.toString();\n\n    if (typeof(obj) === UNDEFINED || obj === null)\n\t\treturn formatted;\n\n\tvar reg = /\\{[^}\\n]*\\}/g;\n\tvar match = formatted.match(reg);\n\n\tif (match === null)\n\t\treturn formatted;\n\n\tvar length = match.length;\n\n\tfor (var i = 0; i < length; i++) {\n\t\tvar prop = match[i];\n\n\t\tvar isEncode = false;\n\t\tvar name = prop.substring(1, prop.length - 1).trim();\n\n\t\tvar format = '';\n\t\tvar index = name.indexOf('|');\n\n\t\tif (index !== -1) {\n\t\t\tformat = name.substring(index + 1, name.length).trim();\n\t\t\tname = name.substring(0, index).trim();\n\t\t}\n\n\t\tif (prop.substring(0, 2) === '{!')\n\t\t\tname = name.substring(1);\n\t\telse\n\t\t\tisEncode = true;\n\n\t\tvar val;\n\n\t\tif (name.indexOf('.') !== -1) {\n\t\t\tvar arr = name.split('.');\n\n\t\t\tif (arr.length === 2)\n\t\t\t\tval = obj[arr[0]][arr[1]];\n\t\t\telse if (arr.length === 3)\n\t\t\t\tval = obj[arr[0]][arr[1]][arr[3]];\n\t\t\telse if (arr.length === 4)\n\t\t\t\tval = obj[arr[0]][arr[1]][arr[3]][arr[4]];\n\t\t\telse if (arr.length === 5)\n\t\t\t\tval = obj[arr[0]][arr[1]][arr[3]][arr[4]][arr[5]];\n\n\t\t} else\n\t\t\tval = name.length === 0 ? obj : obj[name];\n\n\t\tif (typeof(val) === FUNCTION)\n\t\t\tval = val(index);\n\n\t\tif (typeof(val) === UNDEFINED)\n\t\t\treturn;\n\n\t\tif (format.length > 0) {\n\n\t\t\tvar type = typeof(val);\n\t\t\tif (type === STRING) {\n\t\t\t\tvar max = parseInt(format, 10);\n\t\t\t\tif (!isNaN(max))\n\t\t\t\t\tval = val.max(max + 3, '...');\n\n\t\t\t} else if (type === NUMBER || util.isDate(val))\n\t\t\t\tval = val.format(format);\n\t\t}\n\n\t\tval = val.toString().dollar();\n\t\tformatted = formatted.replace(prop, isEncode ? exports.htmlEncode(val) : val);\n\t}\n\n    return formatted;\n};\n\n/*\n\tSet max length of string\n\t@length {Number}\n\t@chars {String} :: optional, default ...\n\treturn {String}\n*/\nString.prototype.max = function(length, chars) {\n\tvar str = this.toString();\n\tchars = chars || '...';\n    return str.length > length ? str.substring(0, length - chars.length) + chars : str;\n};\n\nString.prototype.isJSON = function() {\n\tvar self = this;\n\tif (self.length <= 1)\n\t\treturn false;\n\tvar a = self[0];\n\tvar b = self[self.length - 1];\n\treturn (a === '\"' && b === '\"') || (a === '[' && b === ']') || (a === '{' && b === '}');\n};\n\nString.prototype.isURL = function() {\n\tvar str = this.toString();\n\tif (str.length <= 7)\n\t\treturn false;\n\treturn regexpUrl.test(str);\n};\n\nString.prototype.isEmail = function() {\n\tvar str = this.toString();\n\tif (str.length <= 4)\n\t\treturn false;\n\n\tif (str[0] === '.' || str[str.length - 1] === '.')\n\t\treturn false;\n\n\treturn regexpMail.test(str);\n};\n\n/*\n\t@def {Number} :: optional, default 0\n\treturn {Number}\n*/\nString.prototype.parseInt = function(def) {\n    var num = 0;\n    var str = this.toString();\n\n    if (str.substring(0, 1) === '0')\n\t\tnum = parseInt(str.replace(/\\s/g, '').substring(1), 10);\n    else\n\t\tnum = parseInt(str.replace(/\\s/g, ''), 10);\n\n    if (isNaN(num))\n        return def || 0;\n\n    return num;\n};\n\n/*\n\t@def {Number} :: optional, default 0\n\treturn {Number}\n*/\nString.prototype.parseFloat = function(def) {\n\tvar num = 0;\n    var str = this.toString();\n\n    if (str.substring(0, 1) === '0')\n        num = parseFloat(str.replace(/\\s/g, '').substring(1).replace(',', '.'));\n    else\n        num = parseFloat(str.replace(/\\s/g, '').replace(',', '.'));\n\n    if (isNaN(num))\n        return def || 0;\n\n    return num;\n};\n\nString.prototype.toUnicode = function() {\n    var result = '';\n    var self = this;\n    for(var i = 0; i < self.length; ++i){\n        if(self.charCodeAt(i) > 126 || self.charCodeAt(i) < 32)\n            result += '\\\\u' + self.charCodeAt(i).hex(4);\n        else\n            result += self[i];\n    }\n    return result;\n};\n\nString.prototype.fromUnicode = function() {\n\n\tvar str = this.replace(/\\\\u([\\d\\w]{4})/gi, function (match, v) {\n\t\treturn String.fromCharCode(parseInt(v, 16));\n\t});\n\n\treturn unescape(str);\n};\n\nString.prototype.sha1 = function() {\n\tvar hash = crypto.createHash('sha1');\n\thash.update(this.toString(), ENCODING);\n\treturn hash.digest('hex');\n};\n\nString.prototype.md5 = function() {\n\tvar hash = crypto.createHash('md5');\n\thash.update(this.toString(), ENCODING);\n\treturn hash.digest('hex');\n};\n\n/*\n\t@key {String}\n\t@isUnique {Boolean}\n\treturn {String}\n*/\nString.prototype.encode = function(key, isUnique) {\n\tvar str = '0' + this.toString();\n    var data_count = str.length;\n    var key_count = key.length;\n    var change = str[data_count - 1];\n    var random = isUnique || true ? exports.random(120) + 40 : 65;\n    var count = data_count + (random % key_count);\n    var values = [];\n    var index = 0;\n\n    values[0] = String.fromCharCode(random);\n    var counter = this.length + key.length;\n\n    for (var i = count - 1; i > 0; i--) {\n\t\tindex = str.charCodeAt(i % data_count);\n\t\tvalues[i] = String.fromCharCode(index ^ (key.charCodeAt(i % key_count) ^ random));\n    }\n\n    var hash = new Buffer(counter + '=' + values.join(''), ENCODING).toString('base64').replace(/\\//g, '-').replace(/\\+/g, '_');\n    index = hash.indexOf('=');\n    if (index > 0)\n\t\treturn hash.substring(0, index);\n\n    return hash;\n};\n\n/*\n\t@key {String}\n\treturn {String}\n*/\nString.prototype.decode = function(key) {\n\n\tvar values = this.toString().replace(/\\-/g, '/').replace(/\\_/g, '+');\n\tvar mod = values.length % 4;\n\n\tif (mod > 0) {\n\t\tfor (var i = 0; i < mod; i++)\n\t\t\tvalues += '=';\n\t}\n\n\tvalues = new Buffer(values, 'base64').toString(ENCODING);\n\n\tvar index = values.indexOf('=');\n\tif (index === -1)\n\t\treturn '';\n\n\tvar counter = parseInt(values.substring(0, index), 10);\n\tif (isNaN(counter))\n\t\treturn '';\n\n\tvalues = values.substring(index + 1);\n\n\tvar count = values.length;\n\tvar random = values.charCodeAt(0);\n\n\tvar key_count = key.length;\n\tvar data_count = count - (random % key_count);\n\tvar decrypt_data = [];\n\n\tfor (var i = data_count - 1; i > 0; i--) {\n\t\tindex = values.charCodeAt(i) ^ (random ^ key.charCodeAt(i % key_count));\n\t\tdecrypt_data[i] = String.fromCharCode(index);\n\t}\n\n\tvar val = decrypt_data.join('');\n\n\tif (counter !== val.length + key.length)\n\t\treturn '';\n\n\treturn val;\n};\n\nString.prototype.findURL = function() {\n\n\tvar arr = [];\n\tvar a = this.match(LINK_1);\n\tvar b = this.match(LINK_2);\n\tvar length = 0;\n\n\tif (a !== null) {\n\t\tlength = a.length;\n\t\tfor (var i = 0; i < length; i++)\n\t\t\tarr.push(a[i]);\n\t}\n\n\tif (b !== null) {\n\t\tlength = b.length;\n\t\tfor (var i = 0; i < length; i++)\n\t\t\tarr.push(b[i]);\n\t}\n\n\treturn arr;\n};\n\nString.prototype.findEmail = function() {\n\n\tvar arr = [];\n\tvar a = this.match(EMAIL);\n\tif (a === null)\n\t\treturn [];\n\n\tvar length = a.length;\n\n\tfor (var i = 0; i < length; i++)\n\t\tarr.push(a[i]);\n\n\treturn arr;\n};\n\n/*\n\tConvert value from base64 and save to file\n\t@filename {String}\n\t@callback {Function} :: optional\n\treturn {String}\n*/\nString.prototype.base64ToFile = function(filename, callback) {\n\tvar self = this.toString();\n\n\tvar index = self.indexOf(',');\n\tif (index === -1)\n\t\tindex = 0;\n\telse\n\t\tindex++;\n\n\tif (callback)\n\t\tfs.writeFile(filename, self.substring(index), 'base64', callback);\n\telse\n\t\tfs.writeFile(filename, self.substring(index), 'base64', exports.noop);\n\n\treturn this;\n};\n\n/*\n\tGet content type from base64\n\treturn {String}\n*/\nString.prototype.base64ContentType = function() {\n\tvar self = this.toString();\n\n\tvar index = self.indexOf(';');\n\tif (index === -1)\n\t\treturn '';\n\n\treturn self.substring(5, index);\n};\n\nString.prototype.removeDiacritics = function() {\n\treturn exports.removeDiacritics(this);\n};\n\n/*\n\tIndent\n\t@max {Number}\n\t@c {String} : optional, default SPACE\n\treturn {String}\n*/\nString.prototype.indent = function(max, c) {\n\tvar self = this.toString();\n\treturn new Array(max + 1).join(c || ' ') + self;\n};\n\n/*\n\tisNumber?\n\t@isDecimal {Boolean} :: optional, default false\n\treturn {Boolean}\n*/\nString.prototype.isNumber = function(isDecimal) {\n\n\tvar self = this.toString();\n\n\tif (self.length === 0)\n\t\treturn false;\n\n\tisDecimal = isDecimal || false;\n\n\tfor (var i = 0; i < self.length; i++) {\n\t\tvar ascii = self.charCodeAt(i);\n\n\t\tif (isDecimal) {\n\t\t\tif (ascii === 44 || ascii === 46) {\n\t\t\t\tisDecimal = false;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\n\t\tif (ascii < 48 || ascii > 57)\n\t\t\treturn false;\n\t}\n\n\treturn true;\n};\n\n/*\n\t@max {Number}\n\t@c {String} :: optional\n\treturn {String}\n*/\nString.prototype.padLeft = function(max, c) {\n\tvar self = this.toString();\n\treturn new Array(Math.max(0, max - self.length + 1)).join(c || ' ') + self;\n};\n\n/*\n\t@max {Number}\n\t@c {String} :: optional\n\treturn {String}\n*/\nString.prototype.padRight = function(max, c) {\n\tvar self = this.toString();\n\treturn self + new Array(Math.max(0, max - self.length + 1)).join(c || ' ');\n};\n\n/*\n\tindex {Number}\n\tvalue {String}\n\treturn {String}\n*/\nString.prototype.insert = function(index, value) {\n\tvar str = this.toString();\n\tvar a = str.substring(0, index);\n\tvar b = value.toString() + str.substring(index);\n\treturn a + b;\n};\n\n/*\n\tPrepare string for replacing double dollar\n*/\nString.prototype.dollar = function() {\n\tvar str = this.toString();\n\tvar index = str.indexOf('$', 0);\n\n\twhile (index !== -1) {\n\t\tif (str[index + 1] === '$')\n\t\t\tstr = str.insert(index, '$');\n\t\tindex = str.indexOf('$', index + 2);\n\t}\n\treturn str.toString();\n};\n\n/*\n\tCreate link\n\t@max {Number} :: optional default 60 chars\n\treturn {String}\n*/\nString.prototype.link = function(max) {\n\tmax = max || 60;\n\n\tvar self = this.toString().trim().removeDiacritics().toLowerCase();\n\tvar builder = [];\n\n\tfor (var i = 0; i < self.length; i++) {\n\t\tvar c = self[i];\n\t\tvar code = self.charCodeAt(i);\n\n\t\tif (builder.length >= max)\n\t\t\tbreak;\n\n\t\tif (code > 31 && code < 48) {\n\n\t\t\tif (builder[builder.length - 1] === '-')\n\t\t\t\tcontinue;\n\n\t\t\tbuilder.push('-');\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (code > 47 && code < 58) {\n\t\t\tbuilder.push(c);\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (code > 94 && code < 123) {\n\t\t\tbuilder.push(c);\n\t\t\tcontinue;\n\t\t}\n\n\t}\n\n\treturn builder.join('');\n};\n\nString.prototype.pluralize = function(zero, one, few, other) {\n\tvar str = this.toString();\n\treturn str.parseInt().pluralize(zero, one, few, other);\n};\n\nString.prototype.isBoolean = function() {\n\tvar self = this.toString().toLowerCase();\n\treturn (self === 'true' || self === 'false') ? true : false;\n};\n\n/*\n\t@decimals {Number}\n\treturn {Number}\n*/\nNumber.prototype.floor = function(decimals) {\n\treturn Math.floor(this * Math.pow(10, decimals)) / Math.pow(10, decimals);\n};\n\n/*\n\t@max {Number}\n\t@c {String} :: optional\n\treturn {String}\n*/\nNumber.prototype.padLeft = function(max, c) {\n\treturn this.toString().padLeft(max, c || '0');\n};\n\n/*\n\t@max {Number}\n\t@c {String} :: optional\n\treturn {String}\n*/\nNumber.prototype.padRight = function(max, c) {\n\treturn this.toString().padRight(max, c || '0');\n};\n\n/*\n\tFormat number :: 10000 = 10 000\n\t@format {Number or String} :: number is decimal and string is specified format, example: ## ###.##\n\treturn {String}\n*/\nNumber.prototype.format = function(format) {\n\n\tvar index = 0;\n\tvar num = this.toString();\n\tvar beg = 0;\n\tvar end = 0;\n\tvar max = 0;\n\tvar output = '';\n\n\tif (typeof(format) === STRING) {\n\n\t\tvar d = false;\n\n\t\tfor (var i = 0; i < format.length; i++) {\n\t\t\tvar c = format[i];\n\t\t\tif (c === '#') {\n\t\t\t\tif (d)\n\t\t\t\t\tend++;\n\t\t\t\telse\n\t\t\t\t\tbeg++;\n\t\t\t}\n\n\t\t\tif (c === '.')\n\t\t\t\td = true;\n\t\t}\n\n\t\tvar strBeg = num;\n\t\tvar strEnd = '';\n\n\t\tindex = num.indexOf('.');\n\n\t\tif (index !== -1) {\n\t\t\tstrBeg = num.substring(0, index);\n\t\t\tstrEnd = num.substring(index + 1);\n\t\t}\n\n\t\tif (strBeg.length > beg) {\n\t\t\tmax = strBeg.length - beg;\n\t\t\tvar tmp = '';\n\t\t\tfor (var i = 0; i < max; i++)\n\t\t\t\ttmp += '#';\n\n\t\t\tformat = tmp + format;\n\t\t}\n\n\t\tif (strBeg.length < beg)\n\t\t\tstrBeg = strBeg.padLeft(beg, ' ');\n\n\t\tif (strEnd.length < end)\n\t\t\tstrEnd = strEnd.padRight(end, '0');\n\n\t\tif (strEnd.length > end)\n\t\t\tstrEnd = strEnd.substring(0, end);\n\n\t\td = false;\n\t\tindex = 0;\n\n\t\tvar skip = true;\n\n\t\tfor (var i = 0; i < format.length; i++) {\n\n\t\t\tvar c = format[i];\n\n\t\t\tif (c !== '#') {\n\n\t\t\t\tif (skip)\n\t\t\t\t\tcontinue;\n\n\t\t\t\tif (c === '.') {\n\t\t\t\t\td = true;\n\t\t\t\t\tindex = 0;\n\t\t\t\t}\n\n\t\t\t\toutput += c;\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvar value = d ? strEnd[index] : strBeg[index];\n\n\t\t\tif (skip)\n\t\t\t\tskip = [',', ' '].indexOf(value) !== -1;\n\n\t\t\tif (!skip)\n\t\t\t\toutput += value;\n\n\t\t\tindex++;\n\t\t}\n\n\t\treturn output;\n\t}\n\n\toutput = '### ### ###';\n\tbeg = num.indexOf('.');\n\tmax = format || 0;\n\n\tif (max === 0 && num != -1)\n\t\tmax = num.length - (beg + 1);\n\n\tif (max > 0) {\n\t\toutput += '.';\n\t\tfor (var i = 0; i < max; i++)\n\t\t\toutput += '#';\n\t}\n\n\treturn this.format(output);\n};\n\n/*\n\tPluralize number\n\tzero {String}\n\tone {String}\n\tfew {String}\n\tother {String}\n\treturn {String}\n*/\nNumber.prototype.pluralize = function(zero, one, few, other) {\n\n\tvar num = this;\n\tvar value = '';\n\n\tif (num === 0)\n\t\tvalue = zero || '';\n\telse if (num === 1)\n\t\tvalue = one || '';\n\telse if (num > 1 && num < 5)\n\t\tvalue = few || '';\n\telse\n\t\tvalue = other;\n\n\tvar beg = value.indexOf('#');\n\tvar end = value.lastIndexOf('#');\n\n\tif (beg === -1)\n\t\treturn value;\n\n\tvar format = value.substring(beg, end + 1);\n\treturn num.format(format) + value.replace(format, '');\n};\n\n/*\n\t@length {Number}\n\treturn {String}\n*/\nNumber.prototype.hex = function(length) {\n    var str = this.toString(16).toUpperCase();\n    while(str.length < length)\n        str = '0' + str;\n    return str;\n};\n\n/*\n\tInternal function\n*/\nNumber.prototype.condition = function(ifTrue, ifFalse) {\n\treturn (this % 2 === 0 ? ifTrue : ifFalse) || '';\n};\n\n/*\n\tVAT\n\t@percentage {Number}\n\t@decimals {Number}, optional, default 2,\n\t@includedVAT {Boolean}, optional, default true\n\treturn {Number}\n*/\nNumber.prototype.VAT = function(percentage, decimals, includedVAT) {\n\tvar num = this;\n\tvar type = typeof(decimals);\n\n\tif (type === BOOLEAN) {\n\t\tvar tmp = includedVAT;\n\t\tincludedVAT = decimals;\n\t\tdecimals = tmp;\n\t\ttype = typeof(decimals);\n\t}\n\n\tif (type === UNDEFINED)\n\t\tdecimals = 2;\n\n\tif (typeof(includedVAT) === UNDEFINED)\n\t\tincludedVAT = true;\n\n\tif (percentage === 0 || num === 0)\n\t\treturn num;\n\n\treturn includedVAT ? (num / ((percentage / 100) + 1)).floor(decimals) : (num * ((percentage / 100) + 1)).floor(decimals);\n};\n\n/*\n\tDiscount\n\t@percentage {Number}\n\t@decimals {Number}, optional, default 2\n\treturn {Number}\n*/\nNumber.prototype.discount = function(percentage, decimals) {\n\tvar num = this;\n\tvar type = typeof(decimals);\n\n\tif (type === UNDEFINED)\n\t\tdecimals = 2;\n\n\treturn (num - (num / 100) * percentage).floor(decimals);\n};\n\nBoolean.prototype.condition = function(ifTrue, ifFalse) {\n\treturn (this ? ifTrue : ifFalse) || '';\n};\n\n/*\n    @count {Number}\n\treturn {Array}\n*/\nArray.prototype.take = function(count) {\n\tvar arr = [];\n\tvar self = this;\n\tfor (var i = 0; i < self.length; i++) {\n\t\tarr.push(self[i]);\n\t\tif (arr.length >= count)\n\t\t\treturn arr;\n\t}\n\treturn arr;\n};\n\n/*\n    @count {Number}\n    return {Array}\n*/\nArray.prototype.skip = function(count) {\n\tvar arr = [];\n\tvar self = this;\n\tfor (var i = 0; i < self.length; i++) {\n\t\tif (i >= count)\n\t\t\tarr.push(self[i]);\n\t}\n\treturn arr;\n};\n\n/*\n\t@cb {Function} :: return true / false\n\treturn {Array}\n*/\nArray.prototype.where = function(cb) {\n\n\tvar self = this;\n\tvar selected = [];\n\n\tfor (var i = 0; i < self.length; i++) {\n\t\tif (cb.call(self, self[i], i))\n\t\t\tselected.push(self[i]);\n\t}\n\n\treturn selected;\n};\n\n/*\n\t@cb {Function} :: return true if is finded\n\treturn {Array item}\n*/\nArray.prototype.find = function(cb) {\n\tvar self = this;\n\tfor (var i = 0; i < self.length; i++) {\n\t\tif (cb.call(self, self[i], i))\n\t\t\treturn self[i];\n\t}\n\treturn null;\n};\n\n/*\n\t@cb {Function} :: return true if is removed\n\treturn {Array}\n*/\nArray.prototype.remove = function(cb) {\n\tvar self = this;\n\tvar arr = [];\n\tfor (var i = 0; i < self.length; i++) {\n\t\tif (!cb.call(self, self[i], i))\n\t\t\tarr.push(self[i]);\n\t}\n\treturn arr;\n};\n\n/*\n\tRandom return item from array\n\tReturn {Object}\n*/\nArray.prototype.random = function() {\n\tvar self = this;\n\treturn self[exports.random(self.length - 1)];\n};\n\n/*\n\tRandomize array\n\tReturn {Array}\n*/\nArray.prototype.randomize = function() {\n\n\tvar self = this;\n\tvar random = (Math.floor(Math.random() * 100000000) * 10).toString();\n\tvar index = 0;\n\tvar old = 0;\n\n\tself.sort(function(a, b) {\n\n\t\tvar c = random[index++];\n\n\t\tif (typeof(c) === UNDEFINED) {\n\t\t\tc = random[0];\n\t\t\tindex = 0;\n\t\t}\n\n\t\tif (old > c) {\n\t\t\told = c;\n\t\t\treturn -1;\n\t\t}\n\n\t\tif (old === c) {\n\t\t\told = c;\n\t\t\treturn 0;\n\t\t}\n\n\t\told = c;\n\t\treturn 1;\n\t});\n\n\treturn self;\n};\n\n/*\n\tAsync class\n*/\nfunction AsyncTask(owner, name, fn, cb, waiting) {\n\n\tthis.handlers = {\n\t\toncomplete: this.complete.bind(this)\n\t};\n\n\tthis.isRunning = 0;\n\tthis.owner = owner;\n\tthis.name = name;\n\tthis.fn = fn;\n\tthis.cb = cb;\n\tthis.waiting = waiting;\n\tthis.interval = null;\n\tthis.isCanceled = false;\n}\n\nAsyncTask.prototype.run = function() {\n\tvar self = this;\n\ttry\n\t{\n\t\tself.isRunning = 1;\n\t\tself.owner.tasksWaiting[self.name] = true;\n\t\tself.owner.emit('begin', self.name);\n\n\t\tvar timeout = self.owner.tasksTimeout[self.name];\n\t\tif (timeout > 0)\n\t\t\tself.interval = setTimeout(self.timeout.bind(self), timeout);\n\n\t\tself.fn(self.handlers.oncomplete);\n\t} catch (ex) {\n\t\tself.owner.emit('error', self.name, ex);\n\t\tself.complete();\n\t}\n\treturn self;\n};\n\nAsyncTask.prototype.timeout = function(timeout) {\n\tvar self = this;\n\n\tif (timeout > 0) {\n\t\tclearTimeout(self.interval);\n\t\tsetTimeout(self.timeout.bind(self), timeout);\n\t\treturn self;\n\t}\n\n\tif (timeout <= 0) {\n\t\tclearTimeout(self.interval);\n\t\tsetTimeout(self.timeout.bind(self), timeout);\n\t\treturn self;\n\t}\n\n\tself.cancel(true);\n\treturn self;\n};\n\nAsyncTask.prototype.cancel = function(isTimeout) {\n\tvar self = this;\n\n\tself.isCanceled = true;\n\n\tif (isTimeout)\n\t\tself.owner.emit('timeout', self.name);\n\telse\n\t\tself.owner.emit('cancel', self.name);\n\n\tself.fn = null;\n\tself.cb = null;\n};\n\nAsyncTask.prototype.complete = function() {\n\n\tvar item = this;\n\tvar self = item.owner;\n\n\titem.isRunning = 2;\n\n\tdelete self.tasksPending[item.name];\n\tdelete self.tasksWaiting[item.name];\n\n\tif (!item.isCanceled) {\n\t\ttry\n\t\t{\n\t\t\tself.emit('end', item.name);\n\n\t\t\tif (item.cb)\n\t\t\t\titem.cb();\n\n\t\t} catch (ex) {\n\t\t\tself.emit('error', ex, item.name);\n\t\t}\n\t}\n\n\tself.reload();\n\tself.refresh();\n\n\treturn self;\n};\n\nfunction Async(owner) {\n\n\tthis._max = 0;\n\tthis._count = 0;\n\tthis._isRunning = false;\n\n\tthis.owner = owner;\n\tthis.onComplete = [];\n\n\tthis.tasksPending = {};\n\tthis.tasksWaiting = {};\n\tthis.tasksAll = [];\n\tthis.tasksTimeout = {};\n}\n\nAsync.prototype = {\n\tget count() {\n\t\treturn this._count;\n\t},\n\n\tget percentage() {\n\t\tvar self = this;\n\t\treturn 100 - Math.floor((self._count * 100) / self._max);\n\t}\n}\n\nAsync.prototype.__proto__ = new events.EventEmitter();\n\nAsync.prototype.reload = function() {\n\tvar self = this;\n\tself.tasksAll = Object.keys(self.tasksPending);\n\tself.emit('percentage', self.percentage);\n\treturn self;\n};\n\nAsync.prototype.cancel = function(name) {\n\n\tvar self = this;\n\n\tif (typeof(name) === UNDEFINED) {\n\n\t\tfor (var i = 0; i < self._count; i++)\n\t\t\tself.cancel(tasksAll[i]);\n\n\t\treturn true;\n\t}\n\n\tvar task = self.tasksPending[name];\n\n\tif (!task)\n\t\treturn false;\n\n\tdelete self.tasksPending[name];\n\tdelete self.tasksWaiting[name];\n\n\ttask.cancel();\n\tself.reload();\n\tself.refresh();\n\n\treturn true;\n};\n\nAsync.prototype.await = function(name, fn, cb) {\n\n\tvar self = this;\n\n\tif (typeof(name) === FUNCTION) {\n\t\tcb = fn;\n\t\tfn = name;\n\t\tname = exports.GUID(6);\n\t}\n\n\tif (typeof(self.tasksPending[name]) !== UNDEFINED)\n\t\treturn false;\n\n\tself.tasksPending[name] = new AsyncTask(self, name, fn, cb, null);\n\tself._max++;\n\tself.reload();\n\tself.refresh();\n\n\treturn true;\n};\n\nAsync.prototype.wait = function(name, waitingFor, fn, cb) {\n\n\tvar self = this;\n\n\tif (typeof(waitingFor) === FUNCTION) {\n\t\tcb = fn;\n\t\tfn = waitingFor;\n\t\twaitingFor = name;\n\t\tname = exports.GUID(6);\n\t}\n\n\tif (typeof(self.tasksPending[name]) !== UNDEFINED)\n\t\treturn false;\n\n\tself.tasksPending[name] = new AsyncTask(self, name, fn, cb, waitingFor);\n\tself._max++;\n\tself.reload();\n\tself.refresh();\n\n\treturn true;\n\n};\n\nAsync.prototype.complete = function(fn) {\n\treturn this.run(fn);\n};\n\nAsync.prototype.run = function(fn) {\n\tvar self = this;\n\tself._isRunning = true;\n\n\tif (fn)\n\t\tself.onComplete.push(fn);\n\n\tself.refresh();\n\treturn self;\n};\n\nAsync.prototype.isRunning = function(name) {\n\n\tvar self = this;\n\n\tif (!name)\n\t\treturn self._isRunning;\n\n\tvar task = self.tasksPending[name];\n\tif (!task)\n\t\treturn false;\n\n\treturn task.isRunning === 1;\n};\n\nAsync.prototype.isWaiting = function(name) {\n\tvar self = this;\n\n\tvar task = self.tasksPending[name];\n\tif (!task)\n\t\treturn false;\n\n\treturn task.isRunning === 0;\n};\n\nAsync.prototype.isPending = function(name) {\n\tvar self = this;\n\tvar task = self.tasksPending[name];\n\tif (!task)\n\t\treturn false;\n\treturn true;\n};\n\nAsync.prototype.timeout = function(name, timeout) {\n\n\tvar self = this;\n\n\tif (timeout <= 0 || typeof(timeout) === UNDEFINED) {\n\t\tdelete self.tasksTimeout[name];\n\t\treturn self;\n\t}\n\n\tself.tasksTimeout[name] = timeout;\n\treturn self;\n};\n\nAsync.prototype.refresh = function(name) {\n\n\tvar self = this;\n\n\tif (!self._isRunning)\n\t\treturn self;\n\n\tself._count = self.tasksAll.length;\n\n\tfor (var i = 0; i < self._count; i++) {\n\n\t\tvar task = self.tasksPending[self.tasksAll[i]];\n\n\t\tif (task.isRunning !== 0)\n\t\t\tcontinue;\n\n\t\tif (task.waiting !== null && typeof(self.tasksWaiting[task.waiting]) !== UNDEFINED)\n\t\t\tcontinue;\n\n\t\ttask.run();\n\t}\n\n\tif (self._count === 0) {\n\t\tself._isRunning = false;\n\t\tself.emit('complete');\n\t\tself.emit('percentage', 100);\n\t\tself._max = 0;\n\t\tvar complete = self.onComplete;\n\t\tvar length = complete.length;\n\t\tself.onComplete = [];\n\t\tfor (var i = 0; i < length; i++) {\n\t\t\ttry\n\t\t\t{\n\t\t\t\tcomplete[i]();\n\t\t\t} catch (ex) {\n\t\t\t\tself.emit('error', ex);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn self;\n};\n\nexports.Async = Async;\nexports.async = Async;\n\nglobal.expression = expression;\nglobal.utils = exports;"},"sourceMaps":null,"error":null,"hash":"e696eb955a760a5ff3a818b44a77ec40","cacheData":{"env":{}}}